#include "defs.h"
#include <stddef.h>

// Auto-generated code for recompilation of target [podofopdfinfo]


#define _BoolDef _Bool

typedef signed int _Unwind_Sword;
typedef unsigned int _Unwind_Ptr;
typedef unsigned int _Unwind_Internal_Ptr;
typedef unsigned int _Unwind_Word;
typedef int _Unwind_Action;
typedef unsigned long _Unwind_Exception_Class;
enum $BDF88968CAE1EA74E42809B9AE857E7C{  _URC_NO_REASON = 0x0,  _URC_FOREIGN_EXCEPTION_CAUGHT = 0x1,  _URC_FATAL_PHASE2_ERROR = 0x2,  _URC_FATAL_PHASE1_ERROR = 0x3,  _URC_NORMAL_STOP = 0x4,  _URC_END_OF_STACK = 0x5,  _URC_HANDLER_FOUND = 0x6,  _URC_INSTALL_CONTEXT = 0x7,  _URC_CONTINUE_UNWIND = 0x8,};
typedef enum $BDF88968CAE1EA74E42809B9AE857E7C $BDF88968CAE1EA74E42809B9AE857E7C;
typedef enum $BDF88968CAE1EA74E42809B9AE857E7C _Unwind_Reason_Code;
typedef struct _Unwind_Exception _Unwind_Exception;
typedef struct _Unwind_Context _Unwind_Context;
typedef void ( *_Unwind_Exception_Cleanup_Fn)(enum $BDF88968CAE1EA74E42809B9AE857E7C, struct _Unwind_Exception *);
typedef _Unwind_Reason_Code ( *_Unwind_Personality_Fn)(int, _Unwind_Action, unsigned long, struct _Unwind_Exception *, struct _Unwind_Context *);
typedef _Unwind_Reason_Code ( *_Unwind_Stop_Fn)(int, _Unwind_Action, unsigned long, struct _Unwind_Exception *, struct _Unwind_Context *, void *);
typedef _Unwind_Sword __guard;
typedef struct type_info type_info;
typedef struct __class_type_info __class_type_info;
enum $30552BE8D9C6A41A52D422625EC0E786{  ft_sfnt_head = 0x0,  ft_sfnt_maxp = 0x1,  ft_sfnt_os2 = 0x2,  ft_sfnt_hhea = 0x3,  ft_sfnt_vhea = 0x4,  ft_sfnt_post = 0x5,  ft_sfnt_pclt = 0x6,  sfnt_max = 0x7,};
typedef enum $30552BE8D9C6A41A52D422625EC0E786 $30552BE8D9C6A41A52D422625EC0E786;
typedef $30552BE8D9C6A41A52D422625EC0E786 FT_Sfnt_Tag;
enum _FcMatchKind{  FcMatchPattern = 0x0,  FcMatchFont = 0x1,  FcMatchScan = 0x2,};
typedef enum _FcMatchKind _FcMatchKind;
typedef _FcMatchKind FcMatchKind;
enum FT_Encoding_{  FT_ENCODING_NONE = 0x0,  FT_ENCODING_MS_SYMBOL = 0x73796D62,  FT_ENCODING_UNICODE = 0x756E6963,  FT_ENCODING_SJIS = 0x736A6973,  FT_ENCODING_GB2312 = 0x67622020,  FT_ENCODING_BIG5 = 0x62696735,  FT_ENCODING_WANSUNG = 0x77616E73,  FT_ENCODING_JOHAB = 0x6A6F6861,  FT_ENCODING_MS_SJIS = 0x736A6973,  FT_ENCODING_MS_GB2312 = 0x67622020,  FT_ENCODING_MS_BIG5 = 0x62696735,  FT_ENCODING_MS_WANSUNG = 0x77616E73,  FT_ENCODING_MS_JOHAB = 0x6A6F6861,  FT_ENCODING_ADOBE_STANDARD = 0x41444F42,  FT_ENCODING_ADOBE_EXPERT = 0x41444245,  FT_ENCODING_ADOBE_CUSTOM = 0x41444243,  FT_ENCODING_ADOBE_LATIN_1 = 0x6C617431,  FT_ENCODING_OLD_LATIN_2 = 0x6C617432,  FT_ENCODING_APPLE_ROMAN = 0x61726D6E,};
typedef enum FT_Encoding_ FT_Encoding_;
typedef FT_Encoding_ FT_Encoding;
enum _FcResult{  FcResultMatch = 0x0,  FcResultNoMatch = 0x1,  FcResultTypeMismatch = 0x2,  FcResultNoId = 0x3,  FcResultOutOfMemory = 0x4,};
typedef enum _FcResult _FcResult;
typedef _FcResult FcResult;
enum _FcType{  FcTypeVoid = 0x0,  FcTypeInteger = 0x1,  FcTypeDouble = 0x2,  FcTypeString = 0x3,  FcTypeBool = 0x4,  FcTypeMatrix = 0x5,  FcTypeCharSet = 0x6,  FcTypeFTFace = 0x7,  FcTypeLangSet = 0x8,};
typedef enum _FcType _FcType;
typedef _FcType FcType;

typedef unsigned char FcChar8;
typedef int FcBool;
typedef struct _FcMatrix{  double xx;  double xy;  double yx;  double yy;} _FcMatrix;
typedef _FcMatrix FcMatrix;
typedef struct _FcCharSet _FcCharSet;
typedef struct _FcCharSet FcCharSet;
typedef struct _FcPattern _FcPattern;
typedef struct _FcPattern FcPattern;
typedef struct _FcLangSet _FcLangSet;
typedef struct _FcLangSet FcLangSet;
typedef union _FcValue__$4C90D9DC80941421F4625716AB95C5A2{const FcChar8 *s;  int i;  int b;  double d;  const FcMatrix *m;  const FcCharSet *c;  void *f;  const FcPattern *p;  const FcLangSet *l;} _FcValue__$4C90D9DC80941421F4625716AB95C5A2;
typedef union $D1D0F511BF997F52624AFB2B0CE27B40{char __size[4];  int __align;} $D1D0F511BF997F52624AFB2B0CE27B40;
typedef $D1D0F511BF997F52624AFB2B0CE27B40 pthread_mutexattr_t;

typedef struct tm{  int tm_sec;  int tm_min;  int tm_hour;  int tm_mday;  int tm_mon;  int tm_year;  int tm_wday;  int tm_yday;  int tm_isdst;  int tm_gmtoff;  const char *tm_zone;} tm;
typedef struct Format Format;
typedef struct PoDoFo PoDoFo;
typedef struct PdfInfo PdfInfo;
struct _FcValue;
typedef struct _FcValue{  _FcType type;  union _FcValue__$4C90D9DC80941421F4625716AB95C5A2 u;} _FcValue;
typedef _FcValue FcValue;
struct PoDoFo__PdfError;
typedef struct PoDoFo__PdfError PoDoFo__PdfError;
typedef struct PoDoFo__PdfDataType PoDoFo__PdfDataType;
typedef struct PoDoFo__PdfVariant PoDoFo__PdfVariant;
typedef struct PoDoFo__PdfObject PoDoFo__PdfObject;
typedef struct PoDoFo__PdfDictionary PoDoFo__PdfDictionary;
typedef struct PoDoFo__PdfOwnedDataType PoDoFo__PdfOwnedDataType;
typedef struct PoDoFo__PdfErrorInfo PoDoFo__PdfErrorInfo;
typedef struct PoDoFo__PdfTokenizer PoDoFo__PdfTokenizer;
typedef struct PoDoFo__PdfReference PoDoFo__PdfReference;
typedef struct PoDoFo__PdfEncrypt PoDoFo__PdfEncrypt;
typedef struct PoDoFo__PdfOutputDevice PoDoFo__PdfOutputDevice;
typedef struct PoDoFo__PdfRefCountedBuffer PoDoFo__PdfRefCountedBuffer;
typedef struct PoDoFo__PdfRect PoDoFo__PdfRect;
typedef struct PoDoFo__PdfStream PoDoFo__PdfStream;
typedef struct PoDoFo__PdfMemoryOutputStream PoDoFo__PdfMemoryOutputStream;
typedef struct PoDoFo__PdfString PoDoFo__PdfString;
typedef struct PoDoFo__PdfTokenizerNameSpace PoDoFo__PdfTokenizerNameSpace;
typedef struct PoDoFo__PdfRefCountedInputDevice PoDoFo__PdfRefCountedInputDevice;
typedef struct PoDoFo__PdfVecObjects PoDoFo__PdfVecObjects;
typedef struct __gnu_cxx____ops __gnu_cxx____ops;
typedef struct std____detail___List_node_header std____detail___List_node_header;
typedef struct PoDoFo__PdfElement PoDoFo__PdfElement;
typedef struct PoDoFo__PdfDocument PoDoFo__PdfDocument;
typedef struct PoDoFo__PdfMemDocument PoDoFo__PdfMemDocument;
typedef struct PoDoFo__PdfDestination PoDoFo__PdfDestination;
typedef struct PoDoFo__PdfFileSpec PoDoFo__PdfFileSpec;
typedef struct PoDoFo__PdfFontCache PoDoFo__PdfFontCache;
typedef struct PoDoFo__PdfFontMetrics PoDoFo__PdfFontMetrics;
typedef struct PoDoFo__PdfFont PoDoFo__PdfFont;
typedef struct PoDoFo__PdfFontConfigWrapper PoDoFo__PdfFontConfigWrapper;
typedef struct PoDoFo__Util__PdfMutexImpl PoDoFo__Util__PdfMutexImpl;
typedef struct PoDoFo__Util__PdfMutex PoDoFo__Util__PdfMutex;
typedef struct PoDoFo__PdfFontFactory PoDoFo__PdfFontFactory;
typedef struct PoDoFo__PdfFontMetricsBase14 PoDoFo__PdfFontMetricsBase14;
typedef struct PoDoFo__PdfFontMetricsFreetype PoDoFo__PdfFontMetricsFreetype;
typedef struct PoDoFo__Scoped_FT_Face PoDoFo__Scoped_FT_Face;
typedef struct PoDoFo__PdfFontMetricsObject PoDoFo__PdfFontMetricsObject;
typedef struct PoDoFo__PdfArray PoDoFo__PdfArray;
typedef struct PoDoFo__PdfFontType1 PoDoFo__PdfFontType1;
typedef struct PoDoFo__PdfType1Encrypt PoDoFo__PdfType1Encrypt;
typedef struct PoDoFo__PdfFontType1Base14 PoDoFo__PdfFontType1Base14;
typedef struct PoDoFo__PdfEncoding PoDoFo__PdfEncoding;
typedef struct PoDoFo__PdfInfo PoDoFo__PdfInfo;
typedef struct PoDoFo__PdfParser PoDoFo__PdfParser;
typedef struct PoDoFo__PdfWriter PoDoFo__PdfWriter;
typedef struct PoDoFo__PdfNameTreeNode PoDoFo__PdfNameTreeNode;
typedef struct PoDoFo__PdfOutlineItem PoDoFo__PdfOutlineItem;
typedef struct PoDoFo__PdfOutlines PoDoFo__PdfOutlines;
typedef struct PoDoFo__PdfCanvas PoDoFo__PdfCanvas;
typedef struct PoDoFo__PdfPage PoDoFo__PdfPage;
typedef struct PoDoFo__PdfColor PoDoFo__PdfColor;
typedef struct PoDoFo__PdfNamedColor PoDoFo__PdfNamedColor;
typedef struct PoDoFo__NamedColorComparatorPredicate PoDoFo__NamedColorComparatorPredicate;
typedef struct PoDoFo__PdfDate PoDoFo__PdfDate;
typedef struct PoDoFo__PdfEncodingFactory PoDoFo__PdfEncodingFactory;
typedef struct PoDoFo__PdfEncryptRC4 PoDoFo__PdfEncryptRC4;
typedef struct PoDoFo__PdfEncryptAESV2 PoDoFo__PdfEncryptAESV2;
typedef struct PoDoFo__PdfEncryptSHABase PoDoFo__PdfEncryptSHABase;
typedef struct PoDoFo__PdfEncryptAESV3 PoDoFo__PdfEncryptAESV3;
typedef struct PoDoFo__PdfInputStream PoDoFo__PdfInputStream;
typedef struct PoDoFo__PdfOutputStream PoDoFo__PdfOutputStream;
typedef struct PoDoFo__AESCryptoEngine PoDoFo__AESCryptoEngine;
typedef struct PoDoFo__RC4CryptoEngine PoDoFo__RC4CryptoEngine;
typedef struct PoDoFo__PdfRC4Stream PoDoFo__PdfRC4Stream;
typedef struct PoDoFo__PdfRC4OutputStream PoDoFo__PdfRC4OutputStream;
typedef struct PoDoFo__PdfRC4InputStream PoDoFo__PdfRC4InputStream;
typedef struct PoDoFo__PdfFileStream PoDoFo__PdfFileStream;
typedef struct PoDoFo__PdfFilter PoDoFo__PdfFilter;
typedef struct PoDoFo__PdfFilterFactory PoDoFo__PdfFilterFactory;
typedef struct PoDoFo__PdfFilteredEncodeStream PoDoFo__PdfFilteredEncodeStream;
typedef struct PoDoFo__PdfFilteredDecodeStream PoDoFo__PdfFilteredDecodeStream;
typedef struct PoDoFo__PdfHexFilter PoDoFo__PdfHexFilter;
typedef struct PoDoFo__PdfAscii85Filter PoDoFo__PdfAscii85Filter;
typedef struct PoDoFo__PdfFlateFilter PoDoFo__PdfFlateFilter;
typedef struct PoDoFo__PdfRLEFilter PoDoFo__PdfRLEFilter;
typedef struct PoDoFo__PdfDCTFilter PoDoFo__PdfDCTFilter;
typedef struct PoDoFo__PdfCCITTFilter PoDoFo__PdfCCITTFilter;
typedef struct PoDoFo__PdfLZWFilter PoDoFo__PdfLZWFilter;
typedef struct PoDoFo__PdfInputDevice PoDoFo__PdfInputDevice;
typedef struct PoDoFo__PdfFileInputStream PoDoFo__PdfFileInputStream;
typedef struct PoDoFo__PdfMemoryInputStream PoDoFo__PdfMemoryInputStream;
typedef struct PoDoFo__PdfDeviceInputStream PoDoFo__PdfDeviceInputStream;
typedef struct PoDoFo__PdfMemStream PoDoFo__PdfMemStream;
typedef struct PoDoFo__PdfBufferOutputStream PoDoFo__PdfBufferOutputStream;
typedef struct PoDoFo__PdfFileOutputStream PoDoFo__PdfFileOutputStream;
typedef struct PoDoFo__PdfDeviceOutputStream PoDoFo__PdfDeviceOutputStream;
typedef struct PoDoFo__PdfParser__TXRefEntry PoDoFo__PdfParser__TXRefEntry;
typedef struct PoDoFo__PdfParserObject PoDoFo__PdfParserObject;
typedef struct PoDoFo__PdfXRefStreamParserObject PoDoFo__PdfXRefStreamParserObject;
typedef struct PoDoFo__PdfRecursionGuard PoDoFo__PdfRecursionGuard;
typedef struct PoDoFo__PdfXRef PoDoFo__PdfXRef;
typedef struct PoDoFo__PdfXRef__TXRefItem PoDoFo__PdfXRef__TXRefItem;
typedef struct PoDoFo__PdfXRefStream PoDoFo__PdfXRefStream;
typedef struct PoDoFo__PdfAcroForm PoDoFo__PdfAcroForm;
typedef struct PoDoFo__PdfContents PoDoFo__PdfContents;
typedef struct PoDoFo__PdfDifferenceEncoding PoDoFo__PdfDifferenceEncoding;
typedef struct PoDoFo__PdfField PoDoFo__PdfField;
typedef struct PoDoFo__PdfButton PoDoFo__PdfButton;
typedef struct PoDoFo__PdfListField PoDoFo__PdfListField;
typedef struct PoDoFo__PdfListBox PoDoFo__PdfListBox;
typedef struct PoDoFo__PdfComboBox PoDoFo__PdfComboBox;
typedef struct PoDoFo__PdfTextField PoDoFo__PdfTextField;
typedef struct PoDoFo__PdfCheckBox PoDoFo__PdfCheckBox;
typedef struct PoDoFo__PdfPushButton PoDoFo__PdfPushButton;
typedef struct PoDoFo__PdfFontCID PoDoFo__PdfFontCID;
typedef struct PoDoFo__PdfFontSimple PoDoFo__PdfFontSimple;
typedef struct PoDoFo__PdfFontTTFSubset PoDoFo__PdfFontTTFSubset;
typedef struct PoDoFo__PdfFontTTFSubset__TTrueTypeTable PoDoFo__PdfFontTTFSubset__TTrueTypeTable;
typedef struct PoDoFo__PdfFontTTFSubset__TGlyphData PoDoFo__PdfFontTTFSubset__TGlyphData;
typedef struct PoDoFo__PdfFontTTFSubset__CMapv4Range PoDoFo__PdfFontTTFSubset__CMapv4Range;
typedef struct PoDoFo__PdfFontTTFSubset__GlyphContext PoDoFo__PdfFontTTFSubset__GlyphContext;
typedef struct PoDoFo__PdfIdentityEncoding PoDoFo__PdfIdentityEncoding;
typedef struct PoDoFo__PdfDocEncoding PoDoFo__PdfDocEncoding;
typedef struct PoDoFo__PdfWinAnsiEncoding PoDoFo__PdfWinAnsiEncoding;
typedef struct PoDoFo__PdfMacRomanEncoding PoDoFo__PdfMacRomanEncoding;
typedef struct PoDoFo__PdfMacExpertEncoding PoDoFo__PdfMacExpertEncoding;
typedef struct PoDoFo__PdfStandardEncoding PoDoFo__PdfStandardEncoding;
typedef struct PoDoFo__PdfSymbolEncoding PoDoFo__PdfSymbolEncoding;
typedef struct PoDoFo__PdfZapfDingbatsEncoding PoDoFo__PdfZapfDingbatsEncoding;
typedef struct PoDoFo__PdfWin1250Encoding PoDoFo__PdfWin1250Encoding;
typedef struct PoDoFo__PdfIso88592Encoding PoDoFo__PdfIso88592Encoding;
typedef struct PoDoFo__PdfSimpleEncoding PoDoFo__PdfSimpleEncoding;
typedef struct PoDoFo__PdfObjectStreamParserObject PoDoFo__PdfObjectStreamParserObject;
typedef struct PoDoFo__PdfCMapEncoding PoDoFo__PdfCMapEncoding;
typedef struct std__istream std__istream;
typedef struct std__ostream std__ostream;
typedef struct std__locale std__locale;
typedef struct std__ios_base__Init std__ios_base__Init;
typedef struct std____detail___List_node_base std____detail___List_node_base;
typedef struct std__ios_base std__ios_base;
typedef struct std___Rb_tree_header std___Rb_tree_header;
typedef struct PoDoFo__PdfName PoDoFo__PdfName;
typedef struct PoDoFo__PdfRefCountedBuffer__TRefCountedBuffer PoDoFo__PdfRefCountedBuffer__TRefCountedBuffer;
typedef struct PoDoFo__PdfAnnotation PoDoFo__PdfAnnotation;
typedef struct PoDoFo__PdfAction PoDoFo__PdfAction;
typedef struct PoDoFo__PdfNamesTree PoDoFo__PdfNamesTree;
typedef struct PoDoFo__TFontCacheElement PoDoFo__TFontCacheElement;
typedef struct PoDoFo__PdfType1EncryptEexec PoDoFo__PdfType1EncryptEexec;
typedef struct PoDoFo__PdfType1EncryptCharstring PoDoFo__PdfType1EncryptCharstring;
typedef struct PoDoFo__PdfExtension PoDoFo__PdfExtension;
typedef struct PoDoFo__PdfPagesTree PoDoFo__PdfPagesTree;
typedef struct PoDoFo__PdfColorGray PoDoFo__PdfColorGray;
typedef struct PoDoFo__PdfColorRGB PoDoFo__PdfColorRGB;
typedef struct PoDoFo__PdfColorCMYK PoDoFo__PdfColorCMYK;
typedef struct PoDoFo__PdfColorCieLab PoDoFo__PdfColorCieLab;
typedef struct PoDoFo__PdfColorSeparationAll PoDoFo__PdfColorSeparationAll;
typedef struct PoDoFo__PdfColorSeparationNone PoDoFo__PdfColorSeparationNone;
typedef struct PoDoFo__PdfColorSeparation PoDoFo__PdfColorSeparation;
typedef struct PoDoFo__PdfData PoDoFo__PdfData;
typedef struct PoDoFo__PdfPredictorDecoder PoDoFo__PdfPredictorDecoder;
typedef struct PoDoFo__PdfEncodingDifference PoDoFo__PdfEncodingDifference;
typedef struct PoDoFo__PdfEncodingDifference__TDifference PoDoFo__PdfEncodingDifference__TDifference;
typedef struct PoDoFo__PdfFontTrueType PoDoFo__PdfFontTrueType;
typedef struct PoDoFo__PdfFontType3 PoDoFo__PdfFontType3;
typedef struct PoDoFo__PdfEncryptRC4Base PoDoFo__PdfEncryptRC4Base;
typedef struct PoDoFo__PdfEncryptAESBase PoDoFo__PdfEncryptAESBase;
typedef struct PoDoFo__PdfEncryptMD5Base PoDoFo__PdfEncryptMD5Base;
typedef struct PoDoFo__PdfLZWFilter__TLzwItem PoDoFo__PdfLZWFilter__TLzwItem;
typedef struct PoDoFo__PdfPagesTreeCache PoDoFo__PdfPagesTreeCache;
typedef struct PoDoFo__PdfAESStream PoDoFo__PdfAESStream;
typedef struct PoDoFo__PdfAESInputStream PoDoFo__PdfAESInputStream;
typedef struct PoDoFo__PdfXRef__PdfXRefBlock PoDoFo__PdfXRef__PdfXRefBlock;
typedef struct PoDoFo__TBFRange PoDoFo__TBFRange;
typedef struct PoDoFo__WidthExporter PoDoFo__WidthExporter;
typedef struct PoDoFo__PdfFontTTFSubset__CMap PoDoFo__PdfFontTTFSubset__CMap;
typedef struct PoDoFo__Util__PdfMutexWrapper PoDoFo__Util__PdfMutexWrapper;
typedef struct PoDoFo__PdfContentsTokenizer PoDoFo__PdfContentsTokenizer;
typedef struct PoDoFo__PdfEncodingObjectFactory PoDoFo__PdfEncodingObjectFactory;

void __prd_init() {
}
void __prd_exit() {
}


/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/



//--------------------------------------------------------------------
// Function Declarations


typedef int (*pPoDoFo__PdfError__PdfError)(PoDoFo__PdfError *, int, char *, int, char *);
pPoDoFo__PdfError__PdfError PoDoFo__PdfError__PdfError = NULL;

typedef void (*pPoDoFo__PdfError___PdfError)(PoDoFo__PdfError *__hidden);
pPoDoFo__PdfError___PdfError PoDoFo__PdfError___PdfError = NULL;

typedef int (*pPoDoFo__PdfEncryptRC4Base__RC4)(PoDoFo__PdfEncryptRC4Base *__hidden, const unsigned char *, int, const unsigned char *, int, unsigned char *, int);
pPoDoFo__PdfEncryptRC4Base__RC4 PoDoFo__PdfEncryptRC4Base__RC4 = NULL;


typedef void * (*pmemcpy)(void *__dest,void *__src,size_t __n);
pmemcpy memcpy=NULL;
typedef void* (*p__cxa_allocate_exception)(size_t);
p__cxa_allocate_exception __cxa_allocate_exception=NULL;
typedef void (*p__cxa_throw)(void*,void*,void*);
p__cxa_throw __cxa_throw=NULL;
typedef int (*pMD5_Final)(char *md,char *c);
pMD5_Final MD5_Final=NULL;
typedef int (*pMD5_Init)(char *c);
pMD5_Init MD5_Init=NULL;
typedef int (*pMD5_Update)(char *c,void *data,size_t len);
pMD5_Update MD5_Update=NULL;



//--------------------------------------------------------------------
// Decompiled Variables

//--------------------------------------------------------------------
// Data declarations

//void *_PoDoFo__PdfError = &EVP_aes_128_cbc; // weak
void *_PoDoFo__PdfError; // _ZTIN6PoDoFo8PdfErrorE




//--------------------------------------------------------------------
// Decompiled Function Declarations

//unsigned int  PoDoFo__PdfEncryptMD5Base__ComputeOwnerKey(PoDoFo__PdfEncryptMD5Base *this, unsigned char *a2, unsigned char *a3, int a4, int a5, _BoolDef a6, unsigned char *a7);
void  PoDoFo__PdfEncryptMD5Base__ComputeOwnerKey(PoDoFo__PdfEncryptMD5Base *this, unsigned char *a2, unsigned char *a3, int a4, int a5, _BoolDef a6, unsigned char *a7);




//--------------------------------------------------------------------
// Decompiled Function Definitions
//----- (00148592) --------------------------------------------------------
void  PoDoFo__PdfEncryptMD5Base__ComputeOwnerKey(PoDoFo__PdfEncryptMD5Base *this, unsigned char *a2, unsigned char *a3, int a4, int a5, _BoolDef a6, unsigned char *a7)
{
  PoDoFo__PdfError *v7; // edi
  PoDoFo__PdfError *v8; // edi
  PoDoFo__PdfError *v9; // edi
  PoDoFo__PdfError *v10; // edi
  PoDoFo__PdfError *v11; // edi
  PoDoFo__PdfError *v12; // edi
  unsigned char v13; // cl
  unsigned int result; // eax
  int v15; // [esp+2Ch] [ebp-ACh] BYREF
  int i; // [esp+30h] [ebp-A8h]
  unsigned int j; // [esp+34h] [ebp-A4h]
  int k; // [esp+38h] [ebp-A0h]
  int v19; // [esp+3Ch] [ebp-9Ch]
  char v20[92]; // [esp+40h] [ebp-98h] BYREF
#ifdef CVE_FIX
  unsigned char v21[32]; // [esp+9Ch] [ebp-3Ch] BYREF
  unsigned char v22[32]; // [esp+ACh] [ebp-2Ch] BYREF
#else
  unsigned char v21[16]; // [esp+9Ch] [ebp-3Ch] BYREF
  unsigned char v22[16]; // [esp+ACh] [ebp-2Ch] BYREF
#endif
  unsigned int v23; // [esp+BCh] [ebp-1Ch]

  v19 = MD5_Init(v20);
  if ( v19 != 1 )
  {
    v7 = (PoDoFo__PdfError *)__cxa_allocate_exception(0x30u);
    v15 = 8;
    PoDoFo__PdfError__PdfError(
      v7,
      (int)&v15,
      "/home/bss-lab-1/research/CGC_GENPROG/FuncRepair/CVE_TESTS/podofo/podofo-0.9.7/src/podofo/base/PdfEncrypt.cpp",
      755,
      "Error initializing MD5 hashing engine");
    __cxa_throw(
      v7,
      (struct type_info *)&_PoDoFo__PdfError,
      (void ( *)(void *))PoDoFo__PdfError___PdfError);
  }
  v19 = MD5_Update(v20, a3, 32);
  if ( v19 != 1 )
  {
    v8 = (PoDoFo__PdfError *)__cxa_allocate_exception(0x30u);
    v15 = 8;
    PoDoFo__PdfError__PdfError(
      v8,
      (int)&v15,
      "/home/bss-lab-1/research/CGC_GENPROG/FuncRepair/CVE_TESTS/podofo/podofo-0.9.7/src/podofo/base/PdfEncrypt.cpp",
      758,
      "Error MD5-hashing data");
    __cxa_throw(
      v8,
      (struct type_info *)&_PoDoFo__PdfError,
      (void ( *)(void *))PoDoFo__PdfError___PdfError);
  }
  v19 = MD5_Final(v22, v20);
  if ( v19 != 1 )
  {
    v9 = (PoDoFo__PdfError *)__cxa_allocate_exception(0x30u);
    v15 = 8;
    PoDoFo__PdfError__PdfError(
      v9,
      (int)&v15,
      "/home/bss-lab-1/research/CGC_GENPROG/FuncRepair/CVE_TESTS/podofo/podofo-0.9.7/src/podofo/base/PdfEncrypt.cpp",
      761,
      "Error MD5-hashing data");
    __cxa_throw(
      v9,
      (struct type_info *)&_PoDoFo__PdfError,
      (void ( *)(void *))PoDoFo__PdfError___PdfError);
  }
  if ( a5 == 3 || a5 == 4 )
  {
    for ( i = 0; i <= 49; ++i )
    {
      v19 = MD5_Init(v20);
      if ( v19 != 1 )
      {
        v10 = (PoDoFo__PdfError *)__cxa_allocate_exception(0x30u);
        v15 = 8;
        PoDoFo__PdfError__PdfError(
          v10,
          (int)&v15,
          "/home/bss-lab-1/research/CGC_GENPROG/FuncRepair/CVE_TESTS/podofo/podofo-0.9.7/src/podofo/base/PdfEncrypt.cpp",
          770,
          "Error initializing MD5 hashing engine");
        __cxa_throw(
          v10,
          (struct type_info *)&_PoDoFo__PdfError,
          (void ( *)(void *))PoDoFo__PdfError___PdfError);
      }
      v19 = MD5_Update(v20, v22, a4);
      if ( v19 != 1 )
      {
        v11 = (PoDoFo__PdfError *)__cxa_allocate_exception(0x30u);
        v15 = 8;
        PoDoFo__PdfError__PdfError(
          v11,
          (int)&v15,
          "/home/bss-lab-1/research/CGC_GENPROG/FuncRepair/CVE_TESTS/podofo/podofo-0.9.7/src/podofo/base/PdfEncrypt.cpp",
          773,
          "Error MD5-hashing data");
        __cxa_throw(
          v11,
          (struct type_info *)&_PoDoFo__PdfError,
          (void ( *)(void *))PoDoFo__PdfError___PdfError);
      }
      v19 = MD5_Final(v22, v20);
      if ( v19 != 1 )
      {
        v12 = (PoDoFo__PdfError *)__cxa_allocate_exception(0x30u);
        v15 = 8;
        PoDoFo__PdfError__PdfError(
          v12,
          (int)&v15,
          "/home/bss-lab-1/research/CGC_GENPROG/FuncRepair/CVE_TESTS/podofo/podofo-0.9.7/src/podofo/base/PdfEncrypt.cpp",
          776,
          "Error MD5-hashing data");
        __cxa_throw(
          v12,
          (struct type_info *)&_PoDoFo__PdfError,
          (void ( *)(void *))PoDoFo__PdfError___PdfError);
      }
    }
    memcpy(a7, a2, 0x20u);
    for ( j = 0; j <= 0x13; ++j )
    {
      for ( k = 0; k < a4; ++k )
      {
        if ( a6 )
          v13 = (19 - j) ^ v22[k];
        else
          v13 = j ^ v22[k];
        v21[k] = v13;
      }
      PoDoFo__PdfEncryptRC4Base__RC4((PoDoFo__PdfEncryptMD5Base *)((char *)this + 240), v21, a4, a7, 32, a7, 32);
    }
  }
  else
  {
    PoDoFo__PdfEncryptRC4Base__RC4((PoDoFo__PdfEncryptMD5Base *)((char *)this + 240), v22, 5, a2, 32, a7, 32);
  }
  return;
}
// C3920: using guessed type int  MD5_Final(int, int);
// C3C50: using guessed type int  MD5_Init(int);
// C3D60: using guessed type int  MD5_Update(int, int, int);
// 1AED20: using guessed type int sub_1AED20(void);
// 2300A0: using guessed type void *PoDoFo__PdfError;

// nfuncs=6989 queued=1 decompiled=1 lumina nreq=0 worse=0 better=0



void  det_PoDoFo__PdfEncryptMD5Base__ComputeOwnerKey(
	void* myPoDoFo__PdfEncryptRC4Base__RC4,
	void* myPoDoFo__PdfError__PdfError,
	void* myPoDoFo__PdfError___PdfError,
    void* *mymemcpy,
    void* *my__cxa_allocate_exception,
    void* *my__cxa_throw,
    void* *myMD5_Final,
    void* *myMD5_Init,
    void* *myMD5_Update,
    void *my__PoDoFo__PdfError,

	PoDoFo__PdfEncryptMD5Base * this,
	unsigned char * a2,
	unsigned char * a3,
	int a4,
	int a5,
	_BoolDef a6,
	unsigned char * a7
)
{


	PoDoFo__PdfEncryptRC4Base__RC4 = (pPoDoFo__PdfEncryptRC4Base__RC4) (myPoDoFo__PdfEncryptRC4Base__RC4);
	PoDoFo__PdfError__PdfError = (pPoDoFo__PdfError__PdfError) (myPoDoFo__PdfError__PdfError);
	PoDoFo__PdfError___PdfError = (pPoDoFo__PdfError___PdfError) (myPoDoFo__PdfError___PdfError);
    memcpy = (pmemcpy)(*mymemcpy);
    __cxa_allocate_exception= (p__cxa_allocate_exception) (*my__cxa_allocate_exception);
    __cxa_throw= (p__cxa_throw) (*my__cxa_throw);
    MD5_Final= (pMD5_Final) (*myMD5_Final);
    MD5_Init= (pMD5_Init) (*myMD5_Init);
    MD5_Update= (pMD5_Update) (*myMD5_Update);
    _PoDoFo__PdfError = my__PoDoFo__PdfError;

	__prd_init();
	PoDoFo__PdfEncryptMD5Base__ComputeOwnerKey(
		this,
		a2,
		a3,
		a4,
		a5,
		a6,
		a7
	);

	__prd_exit();

	 	asm(
"nop\n\t"
"mov    -0x4(%ebp),%ebx\n\t"
"nop\n\t"
"add    $0x14,%esp\n\t"
"nop\n\t"
"pop %ebx\n\t"
"pop %ebp\n\t"
"pop %ecx\n\t"
"add $0x28,%esp\n\t"
"push %ecx\n\t"
"ret\n\t"
);

	return;
}



int main()
{
	det_PoDoFo__PdfEncryptMD5Base__ComputeOwnerKey(
		NULL,
		NULL,
		NULL,
		NULL,
		NULL,
		NULL,
		NULL,
		NULL,
		NULL,
		NULL,
		(PoDoFo__PdfEncryptMD5Base *) NULL,
		(unsigned char *) NULL,
		(unsigned char *) NULL,
		(int) 0,
		(int) 0,
		(_BoolDef) NULL,
		(unsigned char *) NULL
	);
	return 0;
}
